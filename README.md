# Бот-модератор для Telegram чатов

Бот для модерации Telegram чатов с функциями:
- Контроль спама и флуда
- Система предупреждений и наказаний
- Автоматическая очистка старых данных
- Панель администратора
- Гибкая настройка правил и наказаний
- Подробное логирование действий

## Требования
- Python 3.8+
- SQLite3
- Telegram Bot API token

## Установка

1. Клонируйте репозиторий
```bash
git clone [url репозитория]
cd [папка проекта]
```

2. Создайте виртуальное окружение и установите зависимости
```bash
python -m venv venv
source venv/bin/activate  # для Linux/Mac
# или
venv\Scripts\activate  # для Windows
pip install -r requirements.txt
```

3. Настройка конфигурации
```bash
cp config.example.json config.json
```

Отредактируйте `config.json`:
- Укажите токен бота (`bot_token`)
- Добавьте ID разрешенных групп (`allowed_groups`)
- Укажите ID администраторов (`admin_ids`)
- Настройте ID чата для админ-уведомлений (`admin_chat_id`)

## Запуск

```bash
python main.py
```

## Основные функции

### Контроль сообщений
- Проверка наличия реплаев
- Защита от двойных ответов
- Контроль самоответов
- Настраиваемые временные интервалы

### Система наказаний
- Предупреждения
- Временный мут
- Исключение из группы
- Временный бан
- Перманентный бан

### Админ-панель
- Просмотр нарушений
- Отмена наказаний
- Сброс счетчиков
- Восстановление удаленных сообщений

### Автоматизация
- Автоудаление сообщений бота
- Очистка старых данных
- Автоматическое снятие ограничений

## Конфигурация

Основные параметры в `config.json`:

### Правила сообщений
- `message_length_limit`: Максимальная длина сообщения
- `reply_cooldown_seconds`: Временное окно для реплаев
- `ignore_bot_thread_replies`: Игнорировать реплаи на бота

### Наказания
- `mute_duration_seconds`: Длительность мута
- `temp_ban_duration_seconds`: Длительность бана
- `data_retention_days`: Хранение истории

### Уведомления
- `delete_bot_messages`: Автоудаление сообщений
- `bot_message_lifetime_seconds`: Время жизни сообщений
- `delete_penalty_messages`: Удаление уведомлений о наказаниях
- `penalty_message_lifetime_seconds`: Время жизни уведомлений

### Логирование
- Настройка уровней логирования
- Выбор логируемых модулей
- Отслеживание удалений и наказаний

Полное описание параметров смотрите в `info.md`

## База данных

Используется SQLite с автоматической очисткой данных:
- Нарушения (violations)
- Удаленные сообщения (messages_deleted)
- Активные наказания (penalties_active)
- Счетчики нарушений (violation_counters)
- Инциденты пользователей (users_incidents)

## Безопасность

- Проверка прав доступа
- Защита от спама
- Ограничение длины сообщений
- Безопасное хранение данных
- Автоматическая очистка старых записей

## Поддержка

При возникновении проблем:
1. Проверьте логи
2. Убедитесь в правильности конфигурации
3. Создайте issue в репозитории

## Лицензия

MIT License 